function cov_1kevq38yhb(){var path="/Users/abnersiqueira/Documents/car-rent-tdd/src/service/carService.js";var hash="002273cdbedda5746abf77e20a26dd31e5e0a40c";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/abnersiqueira/Documents/car-rent-tdd/src/service/carService.js",statementMap:{"0":{start:{line:1,column:23},end:{line:1,column:67}},"1":{start:{line:2,column:12},end:{line:2,column:40}},"2":{start:{line:3,column:20},end:{line:3,column:56}},"3":{start:{line:7,column:4},end:{line:7,column:59}},"4":{start:{line:8,column:4},end:{line:8,column:46}},"5":{start:{line:9,column:4},end:{line:12,column:6}},"6":{start:{line:16,column:23},end:{line:16,column:34}},"7":{start:{line:17,column:4},end:{line:17,column:49}},"8":{start:{line:21,column:27},end:{line:21,column:78}},"9":{start:{line:22,column:18},end:{line:22,column:52}},"10":{start:{line:23,column:4},end:{line:23,column:16}},"11":{start:{line:27,column:18},end:{line:27,column:51}},"12":{start:{line:28,column:16},end:{line:28,column:52}},"13":{start:{line:29,column:4},end:{line:29,column:14}},"14":{start:{line:33,column:20},end:{line:33,column:28}},"15":{start:{line:34,column:18},end:{line:34,column:35}},"16":{start:{line:35,column:26},end:{line:37,column:5}},"17":{start:{line:36,column:15},end:{line:36,column:47}},"18":{start:{line:39,column:23},end:{line:39,column:49}},"19":{start:{line:40,column:27},end:{line:40,column:65}},"20":{start:{line:42,column:4},end:{line:42,column:25}},"21":{start:{line:46,column:16},end:{line:46,column:55}},"22":{start:{line:47,column:23},end:{line:51,column:5}},"23":{start:{line:53,column:18},end:{line:53,column:28}},"24":{start:{line:54,column:4},end:{line:54,column:49}},"25":{start:{line:55,column:20},end:{line:59,column:5}},"26":{start:{line:60,column:20},end:{line:60,column:62}},"27":{start:{line:62,column:24},end:{line:67,column:6}},"28":{start:{line:69,column:4},end:{line:69,column:22}},"29":{start:{line:73,column:0},end:{line:73,column:27}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:2},end:{line:6,column:3}},loc:{start:{line:6,column:24},end:{line:13,column:3}},line:6},"1":{name:"(anonymous_1)",decl:{start:{line:15,column:2},end:{line:15,column:3}},loc:{start:{line:15,column:35},end:{line:18,column:3}},line:15},"2":{name:"(anonymous_2)",decl:{start:{line:20,column:2},end:{line:20,column:3}},loc:{start:{line:20,column:31},end:{line:24,column:3}},line:20},"3":{name:"(anonymous_3)",decl:{start:{line:26,column:2},end:{line:26,column:3}},loc:{start:{line:26,column:37},end:{line:30,column:3}},line:26},"4":{name:"(anonymous_4)",decl:{start:{line:32,column:2},end:{line:32,column:3}},loc:{start:{line:32,column:59},end:{line:43,column:3}},line:32},"5":{name:"(anonymous_5)",decl:{start:{line:36,column:6},end:{line:36,column:7}},loc:{start:{line:36,column:15},end:{line:36,column:47}},line:36},"6":{name:"(anonymous_6)",decl:{start:{line:45,column:2},end:{line:45,column:3}},loc:{start:{line:45,column:50},end:{line:70,column:3}},line:45}},branchMap:{"0":{loc:{start:{line:36,column:15},end:{line:36,column:47}},type:"binary-expr",locations:[{start:{line:36,column:15},end:{line:36,column:30}},{start:{line:36,column:34},end:{line:36,column:47}}],line:36}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"002273cdbedda5746abf77e20a26dd31e5e0a40c"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1kevq38yhb=function(){return actualCoverage;};}return actualCoverage;}cov_1kevq38yhb();const BaseRepository=(cov_1kevq38yhb().s[0]++,require('../repository/base/baseRepository'));const Tax=(cov_1kevq38yhb().s[1]++,require('./../entities/tax'));const Transaction=(cov_1kevq38yhb().s[2]++,require('./../entities/transaction'));class CarService{constructor({cars}){cov_1kevq38yhb().f[0]++;cov_1kevq38yhb().s[3]++;this.carRepository=new BaseRepository({file:cars});cov_1kevq38yhb().s[4]++;this.taxesBasedOnAge=Tax.taxesBasedOnAge;cov_1kevq38yhb().s[5]++;this.currencyFormat=new Intl.NumberFormat('pt-br',{style:'currency',currency:'BRL'});}getRandomPositionFromArray(list){cov_1kevq38yhb().f[1]++;const listLength=(cov_1kevq38yhb().s[6]++,list.length);cov_1kevq38yhb().s[7]++;return Math.floor(Math.random()*listLength);}chooseRandomCar(carCategory){cov_1kevq38yhb().f[2]++;const randomCarIndex=(cov_1kevq38yhb().s[8]++,this.getRandomPositionFromArray(carCategory.carIds));const carId=(cov_1kevq38yhb().s[9]++,carCategory.carIds[randomCarIndex]);cov_1kevq38yhb().s[10]++;return carId;}async getAvailableCar(carCategory){cov_1kevq38yhb().f[3]++;const carId=(cov_1kevq38yhb().s[11]++,this.chooseRandomCar(carCategory));const car=(cov_1kevq38yhb().s[12]++,await this.carRepository.find(carId));cov_1kevq38yhb().s[13]++;return car;}calculateFinalPrice(customer,carCategory,numberOfDays){cov_1kevq38yhb().f[4]++;const{age}=(cov_1kevq38yhb().s[14]++,customer);const price=(cov_1kevq38yhb().s[15]++,carCategory.price);const{then:tax}=(cov_1kevq38yhb().s[16]++,this.taxesBasedOnAge.find(tax=>{cov_1kevq38yhb().f[5]++;cov_1kevq38yhb().s[17]++;return(cov_1kevq38yhb().b[0][0]++,age>=tax.from)&&(cov_1kevq38yhb().b[0][1]++,age<=tax.to);}));const finalPrice=(cov_1kevq38yhb().s[18]++,tax*price*numberOfDays);const formattedPrice=(cov_1kevq38yhb().s[19]++,this.currencyFormat.format(finalPrice));cov_1kevq38yhb().s[20]++;return formattedPrice;}async rent(customer,carCategory,numberOfDays){cov_1kevq38yhb().f[6]++;const car=(cov_1kevq38yhb().s[21]++,await this.getAvailableCar(carCategory));const finalPrice=(cov_1kevq38yhb().s[22]++,await this.calculateFinalPrice(customer,carCategory,numberOfDays));const today=(cov_1kevq38yhb().s[23]++,new Date());cov_1kevq38yhb().s[24]++;today.setDate(today.getDate()+numberOfDays);const options=(cov_1kevq38yhb().s[25]++,{year:'numeric',month:'long',day:'numeric'});const dueDate=(cov_1kevq38yhb().s[26]++,today.toLocaleDateString('pt-br',options));const transaction=(cov_1kevq38yhb().s[27]++,new Transaction({customer,dueDate,car,amount:finalPrice}));cov_1kevq38yhb().s[28]++;return transaction;}}cov_1kevq38yhb().s[29]++;module.exports=CarService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhclNlcnZpY2UuanMiXSwibmFtZXMiOlsiQmFzZVJlcG9zaXRvcnkiLCJyZXF1aXJlIiwiVGF4IiwiVHJhbnNhY3Rpb24iLCJDYXJTZXJ2aWNlIiwiY29uc3RydWN0b3IiLCJjYXJzIiwiY2FyUmVwb3NpdG9yeSIsImZpbGUiLCJ0YXhlc0Jhc2VkT25BZ2UiLCJjdXJyZW5jeUZvcm1hdCIsIkludGwiLCJOdW1iZXJGb3JtYXQiLCJzdHlsZSIsImN1cnJlbmN5IiwiZ2V0UmFuZG9tUG9zaXRpb25Gcm9tQXJyYXkiLCJsaXN0IiwibGlzdExlbmd0aCIsImxlbmd0aCIsIk1hdGgiLCJmbG9vciIsInJhbmRvbSIsImNob29zZVJhbmRvbUNhciIsImNhckNhdGVnb3J5IiwicmFuZG9tQ2FySW5kZXgiLCJjYXJJZHMiLCJjYXJJZCIsImdldEF2YWlsYWJsZUNhciIsImNhciIsImZpbmQiLCJjYWxjdWxhdGVGaW5hbFByaWNlIiwiY3VzdG9tZXIiLCJudW1iZXJPZkRheXMiLCJhZ2UiLCJwcmljZSIsInRoZW4iLCJ0YXgiLCJmcm9tIiwidG8iLCJmaW5hbFByaWNlIiwiZm9ybWF0dGVkUHJpY2UiLCJmb3JtYXQiLCJyZW50IiwidG9kYXkiLCJEYXRlIiwic2V0RGF0ZSIsImdldERhdGUiLCJvcHRpb25zIiwieWVhciIsIm1vbnRoIiwiZGF5IiwiZHVlRGF0ZSIsInRvTG9jYWxlRGF0ZVN0cmluZyIsInRyYW5zYWN0aW9uIiwiYW1vdW50IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6IjJySEFlWTsyRkFmWixLQUFNQSxDQUFBQSxjQUFjLDBCQUFHQyxPQUFPLENBQUMsbUNBQUQsQ0FBVixDQUFwQixDQUNBLEtBQU1DLENBQUFBLEdBQUcsMEJBQUdELE9BQU8sQ0FBQyxtQkFBRCxDQUFWLENBQVQsQ0FDQSxLQUFNRSxDQUFBQSxXQUFXLDBCQUFHRixPQUFPLENBQUMsMkJBQUQsQ0FBVixDQUFqQixDQUVBLEtBQU1HLENBQUFBLFVBQVcsQ0FDZkMsV0FB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QUZPLENBR2RDLEdBQUcsQ0FBRSxTQUhTLENBQUgsQ0FBYixDQUtBLEtBQU1DLENBQUFBLE9BQU8sMkJBQUdSLEtBQUssQ0FBQ1Msa0JBQU4sQ0FBeUIsT0FBekIsQ0FBa0NMLE9BQWxDLENBQUgsQ0FBYixDQUVBLEtBQU1NLENBQUFBLFdBQVcsMkJBQUcsR0FBSWxELENBQUFBLFdBQUosQ0FBZ0IsQ0FDbEM0QixRQURrQyxDQUVsQ29CLE9BRmtDLENBR2xDdkIsR0FIa0MsQ0FJbEMwQixNQUFNLENBQUVmLFVBSjBCLENBQWhCLENBQUgsQ0FBakIsQ0FqQjhDLHlCQXdCOUMsTUFBT2MsQ0FBQUEsV0FBUCxDQUNELENBakVjLEMseUJBb0VqQkUsTUFBTSxDQUFDQyxPQUFQLENBQWlCcEQsVUFBakIiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBCYXNlUmVwb3NpdG9yeSA9IHJlcXVpcmUoJy4uL3JlcG9zaXRvcnkvYmFzZS9iYXNlUmVwb3NpdG9yeScpXG5jb25zdCBUYXggPSByZXF1aXJlKCcuLy4uL2VudGl0aWVzL3RheCcpXG5jb25zdCBUcmFuc2FjdGlvbiA9IHJlcXVpcmUoJy4vLi4vZW50aXRpZXMvdHJhbnNhY3Rpb24nKVxuXG5jbGFzcyBDYXJTZXJ2aWNlIHtcbiAgY29uc3RydWN0b3IoeyBjYXJzIH0pIHtcbiAgICB0aGlzLmNhclJlcG9zaXRvcnkgPSBuZXcgQmFzZVJlcG9zaXRvcnkoeyBmaWxlOiBjYXJzIH0pXG4gICAgdGhpcy50YXhlc0Jhc2VkT25BZ2UgPSBUYXgudGF4ZXNCYXNlZE9uQWdlXG4gICAgdGhpcy5jdXJyZW5jeUZvcm1hdCA9IG5ldyBJbnRsLk51bWJlckZvcm1hdCgncHQtYnInLCB7XG4gICAgICBzdHlsZTogJ2N1cnJlbmN5JyxcbiAgICAgIGN1cnJlbmN5OiAnQlJMJyxcbiAgICB9KVxuICB9XG5cbiAgZ2V0UmFuZG9tUG9zaXRpb25Gcm9tQXJyYXkobGlzdCkge1xuICAgIGNvbnN0IGxpc3RMZW5ndGggPSBsaXN0Lmxlbmd0aFxuICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBsaXN0TGVuZ3RoKVxuICB9XG5cbiAgY2hvb3NlUmFuZG9tQ2FyKGNhckNhdGVnb3J5KSB7XG4gICAgY29uc3QgcmFuZG9tQ2FySW5kZXggPSB0aGlzLmdldFJhbmRvbVBvc2l0aW9uRnJvbUFycmF5KGNhckNhdGVnb3J5LmNhcklkcylcbiAgICBjb25zdCBjYXJJZCA9IGNhckNhdGVnb3J5LmNhcklkc1tyYW5kb21DYXJJbmRleF1cbiAgICByZXR1cm4gY2FySWRcbiAgfVxuXG4gIGFzeW5jIGdldEF2YWlsYWJsZUNhcihjYXJDYXRlZ29yeSkge1xuICAgIGNvbnN0IGNhcklkID0gdGhpcy5jaG9vc2VSYW5kb21DYXIoY2FyQ2F0ZWdvcnkpXG4gICAgY29uc3QgY2FyID0gYXdhaXQgdGhpcy5jYXJSZXBvc2l0b3J5LmZpbmQoY2FySWQpXG4gICAgcmV0dXJuIGNhclxuICB9XG5cbiAgY2FsY3VsYXRlRmluYWxQcmljZShjdXN0b21lciwgY2FyQ2F0ZWdvcnksIG51bWJlck9mRGF5cykge1xuICAgIGNvbnN0IHsgYWdlIH0gPSBjdXN0b21lclxuICAgIGNvbnN0IHByaWNlID0gY2FyQ2F0ZWdvcnkucHJpY2VcbiAgICBjb25zdCB7IHRoZW46IHRheCB9ID0gdGhpcy50YXhlc0Jhc2VkT25BZ2UuZmluZChcbiAgICAgICh0YXgpID0+IGFnZSA+PSB0YXguZnJvbSAmJiBhZ2UgPD0gdGF4LnRvXG4gICAgKVxuXG4gICAgY29uc3QgZmluYWxQcmljZSA9IHRheCAqIHByaWNlICogbnVtYmVyT2ZEYXlzXG4gICAgY29uc3QgZm9ybWF0dGVkUHJpY2UgPSB0aGlzLmN1cnJlbmN5Rm9ybWF0LmZvcm1hdChmaW5hbFByaWNlKVxuXG4gICAgcmV0dXJuIGZvcm1hdHRlZFByaWNlXG4gIH1cblxuICBhc3luYyByZW50KGN1c3RvbWVyLCBjYXJDYXRlZ29yeSwgbnVtYmVyT2ZEYXlzKSB7XG4gICAgY29uc3QgY2FyID0gYXdhaXQgdGhpcy5nZXRBdmFpbGFibGVDYXIoY2FyQ2F0ZWdvcnkpXG4gICAgY29uc3QgZmluYWxQcmljZSA9IGF3YWl0IHRoaXMuY2FsY3VsYXRlRmluYWxQcmljZShcbiAgICAgIGN1c3RvbWVyLFxuICAgICAgY2FyQ2F0ZWdvcnksXG4gICAgICBudW1iZXJPZkRheXNcbiAgICApXG5cbiAgICBjb25zdCB0b2RheSA9IG5ldyBEYXRlKClcbiAgICB0b2RheS5zZXREYXRlKHRvZGF5LmdldERhdGUoKSArIG51bWJlck9mRGF5cylcbiAgICBjb25zdCBvcHRpb25zID0ge1xuICAgICAgeWVhcjogJ251bWVyaWMnLFxuICAgICAgbW9udGg6ICdsb25nJyxcbiAgICAgIGRheTogJ251bWVyaWMnLFxuICAgIH1cbiAgICBjb25zdCBkdWVEYXRlID0gdG9kYXkudG9Mb2NhbGVEYXRlU3RyaW5nKCdwdC1icicsIG9wdGlvbnMpXG5cbiAgICBjb25zdCB0cmFuc2FjdGlvbiA9IG5ldyBUcmFuc2FjdGlvbih7XG4gICAgICBjdXN0b21lcixcbiAgICAgIGR1ZURhdGUsXG4gICAgICBjYXIsXG4gICAgICBhbW91bnQ6IGZpbmFsUHJpY2UsXG4gICAgfSlcblxuICAgIHJldHVybiB0cmFuc2FjdGlvblxuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gQ2FyU2VydmljZVxuIl19