function cov_2o3jjv4abg(){var path="/Users/abnersiqueira/Documents/car-rent-tdd/test/unitTests/carService.test.js";var hash="cd3ff32c075e6c2bcc983c0179b6bae6732d204a";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/abnersiqueira/Documents/car-rent-tdd/test/unitTests/carService.test.js",statementMap:{"0":{start:{line:1,column:56},end:{line:1,column:72}},"1":{start:{line:2,column:19},end:{line:2,column:34}},"2":{start:{line:3,column:14},end:{line:3,column:30}},"3":{start:{line:5,column:17},end:{line:5,column:32}},"4":{start:{line:6,column:19},end:{line:6,column:58}},"5":{start:{line:7,column:20},end:{line:7,column:63}},"6":{start:{line:9,column:21},end:{line:9,column:69}},"7":{start:{line:11,column:14},end:{line:15,column:1}},"8":{start:{line:17,column:0},end:{line:134,column:2}},"9":{start:{line:18,column:19},end:{line:18,column:21}},"10":{start:{line:20,column:2},end:{line:24,column:4}},"11":{start:{line:21,column:4},end:{line:23,column:6}},"12":{start:{line:26,column:2},end:{line:28,column:4}},"13":{start:{line:27,column:4},end:{line:27,column:35}},"14":{start:{line:30,column:2},end:{line:32,column:4}},"15":{start:{line:31,column:4},end:{line:31,column:21}},"16":{start:{line:34,column:2},end:{line:38,column:4}},"17":{start:{line:35,column:17},end:{line:35,column:32}},"18":{start:{line:36,column:19},end:{line:36,column:62}},"19":{start:{line:37,column:4},end:{line:37,column:55}},"20":{start:{line:40,column:2},end:{line:52,column:4}},"21":{start:{line:41,column:24},end:{line:41,column:46}},"22":{start:{line:42,column:4},end:{line:42,column:18}},"23":{start:{line:44,column:4},end:{line:46,column:26}},"24":{start:{line:48,column:19},end:{line:48,column:58}},"25":{start:{line:49,column:21},end:{line:49,column:51}},"26":{start:{line:50,column:4},end:{line:50,column:69}},"27":{start:{line:51,column:4},end:{line:51,column:40}},"28":{start:{line:54,column:2},end:{line:70,column:4}},"29":{start:{line:55,column:16},end:{line:55,column:30}},"30":{start:{line:56,column:24},end:{line:56,column:61}},"31":{start:{line:57,column:4},end:{line:57,column:33}},"32":{start:{line:59,column:4},end:{line:61,column:20}},"33":{start:{line:63,column:4},end:{line:63,column:60}},"34":{start:{line:65,column:19},end:{line:65,column:64}},"35":{start:{line:66,column:21},end:{line:66,column:24}},"36":{start:{line:67,column:4},end:{line:67,column:58}},"37":{start:{line:68,column:4},end:{line:68,column:76}},"38":{start:{line:69,column:4},end:{line:69,column:45}},"39":{start:{line:72,column:2},end:{line:97,column:4}},"40":{start:{line:73,column:21},end:{line:73,column:55}},"41":{start:{line:74,column:4},end:{line:74,column:21}},"42":{start:{line:76,column:24},end:{line:76,column:61}},"43":{start:{line:77,column:4},end:{line:77,column:28}},"44":{start:{line:79,column:25},end:{line:79,column:26}},"45":{start:{line:85,column:4},end:{line:87,column:51}},"46":{start:{line:87,column:17},end:{line:87,column:50}},"47":{start:{line:89,column:21},end:{line:89,column:60}},"48":{start:{line:90,column:19},end:{line:94,column:5}},"49":{start:{line:96,column:4},end:{line:96,column:45}},"50":{start:{line:99,column:2},end:{line:133,column:4}},"51":{start:{line:100,column:16},end:{line:100,column:30}},"52":{start:{line:101,column:24},end:{line:105,column:5}},"53":{start:{line:107,column:21},end:{line:107,column:55}},"54":{start:{line:108,column:4},end:{line:108,column:21}},"55":{start:{line:110,column:25},end:{line:110,column:26}},"56":{start:{line:111,column:20},end:{line:111,column:40}},"57":{start:{line:113,column:16},end:{line:113,column:36}},"58":{start:{line:114,column:4},end:{line:114,column:40}},"59":{start:{line:118,column:4},end:{line:120,column:20}},"60":{start:{line:122,column:27},end:{line:122,column:66}},"61":{start:{line:123,column:19},end:{line:123,column:77}},"62":{start:{line:125,column:21},end:{line:130,column:6}},"63":{start:{line:132,column:4},end:{line:132,column:45}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:17,column:35},end:{line:17,column:36}},loc:{start:{line:17,column:41},end:{line:134,column:1}},line:17},"1":{name:"(anonymous_1)",decl:{start:{line:20,column:9},end:{line:20,column:10}},loc:{start:{line:20,column:15},end:{line:24,column:3}},line:20},"2":{name:"(anonymous_2)",decl:{start:{line:26,column:13},end:{line:26,column:14}},loc:{start:{line:26,column:19},end:{line:28,column:3}},line:26},"3":{name:"(anonymous_3)",decl:{start:{line:30,column:12},end:{line:30,column:13}},loc:{start:{line:30,column:18},end:{line:32,column:3}},line:30},"4":{name:"(anonymous_4)",decl:{start:{line:34,column:57},end:{line:34,column:58}},loc:{start:{line:34,column:63},end:{line:38,column:3}},line:34},"5":{name:"(anonymous_5)",decl:{start:{line:40,column:62},end:{line:40,column:63}},loc:{start:{line:40,column:68},end:{line:52,column:3}},line:40},"6":{name:"(anonymous_6)",decl:{start:{line:54,column:62},end:{line:54,column:63}},loc:{start:{line:54,column:74},end:{line:70,column:3}},line:54},"7":{name:"(anonymous_7)",decl:{start:{line:72,column:100},end:{line:72,column:101}},loc:{start:{line:72,column:112},end:{line:97,column:3}},line:72},"8":{name:"(anonymous_8)",decl:{start:{line:87,column:11},end:{line:87,column:12}},loc:{start:{line:87,column:17},end:{line:87,column:50}},line:87},"9":{name:"(anonymous_9)",decl:{start:{line:99,column:83},end:{line:99,column:84}},loc:{start:{line:99,column:95},end:{line:133,column:3}},line:99}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},b:{},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"cd3ff32c075e6c2bcc983c0179b6bae6732d204a"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_2o3jjv4abg=function(){return actualCoverage;};}return actualCoverage;}cov_2o3jjv4abg();const{describe,it,before,beforeEach,afterEach}=(cov_2o3jjv4abg().s[0]++,require('mocha'));const{expect}=(cov_2o3jjv4abg().s[1]++,require('chai'));const sinon=(cov_2o3jjv4abg().s[2]++,require('sinon'));const{join}=(cov_2o3jjv4abg().s[3]++,require('path'));const CarService=(cov_2o3jjv4abg().s[4]++,require('../../src/service/carService'));const Transaction=(cov_2o3jjv4abg().s[5]++,require('./../../src/entities/transaction'));const carsDatabase=(cov_2o3jjv4abg().s[6]++,join(__dirname,'./../../database','cars.json'));const mocks=(cov_2o3jjv4abg().s[7]++,{validCarCategory:require('./../mocks/valid-carCategory.json'),validCar:require('./../mocks/valid-car.json'),validCustomer:require('./../mocks/valid-customer.json')});cov_2o3jjv4abg().s[8]++;describe('CarService Tests Suite',()=>{cov_2o3jjv4abg().f[0]++;let carService=(cov_2o3jjv4abg().s[9]++,{});cov_2o3jjv4abg().s[10]++;before(()=>{cov_2o3jjv4abg().f[1]++;cov_2o3jjv4abg().s[11]++;carService=new CarService({cars:carsDatabase});});cov_2o3jjv4abg().s[12]++;beforeEach(()=>{cov_2o3jjv4abg().f[2]++;cov_2o3jjv4abg().s[13]++;sandbox=sinon.createSandbox();});cov_2o3jjv4abg().s[14]++;afterEach(()=>{cov_2o3jjv4abg().f[3]++;cov_2o3jjv4abg().s[15]++;sandbox.restore();});cov_2o3jjv4abg().s[16]++;it('should retrieve a random position from the array',()=>{cov_2o3jjv4abg().f[4]++;const data=(cov_2o3jjv4abg().s[17]++,[0,1,2,3,4]);const result=(cov_2o3jjv4abg().s[18]++,carService.getRandomPositionFromArray(data));cov_2o3jjv4abg().s[19]++;expect(result).to.be.lte(data.length).and.be.gte(0);});cov_2o3jjv4abg().s[20]++;it('should choose the first id from carIds in carCategory',()=>{cov_2o3jjv4abg().f[5]++;const carCategory=(cov_2o3jjv4abg().s[21]++,mocks.validCarCategory);cov_2o3jjv4abg().s[22]++;carIdIndex=0;cov_2o3jjv4abg().s[23]++;sandbox.stub(carService,carService.getRandomPositionFromArray.name).returns(carIdIndex);const result=(cov_2o3jjv4abg().s[24]++,carService.chooseRandomCar(carCategory));const expected=(cov_2o3jjv4abg().s[25]++,carCategory.carIds[carIdIndex]);cov_2o3jjv4abg().s[26]++;expect(carService.getRandomPositionFromArray.calledOnce).to.be.ok;cov_2o3jjv4abg().s[27]++;expect(result).to.be.equal(expected);});cov_2o3jjv4abg().s[28]++;it('given a carCategory it should return an available car',async()=>{cov_2o3jjv4abg().f[6]++;const car=(cov_2o3jjv4abg().s[29]++,mocks.validCar);const carCategory=(cov_2o3jjv4abg().s[30]++,Object.create(mocks.validCarCategory));cov_2o3jjv4abg().s[31]++;carCategory.carIds=[car.id];cov_2o3jjv4abg().s[32]++;sandbox.stub(carService.carRepository,carService.carRepository.find.name).resolves(car);cov_2o3jjv4abg().s[33]++;sandbox.spy(carService,carService.chooseRandomCar.name);const result=(cov_2o3jjv4abg().s[34]++,await carService.getAvailableCar(carCategory));const expected=(cov_2o3jjv4abg().s[35]++,car);cov_2o3jjv4abg().s[36]++;expect(carService.chooseRandomCar.calledOnce).to.be.ok;cov_2o3jjv4abg().s[37]++;expect(carService.carRepository.find.calledWithExactly(car.id)).to.be.ok;cov_2o3jjv4abg().s[38]++;expect(result).to.be.deep.equal(expected);});cov_2o3jjv4abg().s[39]++;it('given a carCategory, customer and numberOfDays it should calculate the final amount in real',async()=>{cov_2o3jjv4abg().f[7]++;const customer=(cov_2o3jjv4abg().s[40]++,Object.create(mocks.validCustomer));cov_2o3jjv4abg().s[41]++;customer.age=50;const carCategory=(cov_2o3jjv4abg().s[42]++,Object.create(mocks.validCarCategory));cov_2o3jjv4abg().s[43]++;carCategory.price=37.6;const numberOfDays=(cov_2o3jjv4abg().s[44]++,5);// age: 50 - tax: 1.3 - categoryPrice: 37.6
// 37.6 * 1.3 = 48.88 * 5 days = 244.40
// do not depend on external data
cov_2o3jjv4abg().s[45]++;sandbox.stub(carService,'taxesBasedOnAge').get(()=>{cov_2o3jjv4abg().f[8]++;cov_2o3jjv4abg().s[46]++;return[{from:40,to:50,then:1.3}];});const expected=(cov_2o3jjv4abg().s[47]++,carService.currencyFormat.format(244.4));const result=(cov_2o3jjv4abg().s[48]++,carService.calculateFinalPrice(customer,carCategory,numberOfDays));cov_2o3jjv4abg().s[49]++;expect(result).to.be.deep.equal(expected);});cov_2o3jjv4abg().s[50]++;it('given a customer and a car category it should return a transaction receipt',async()=>{cov_2o3jjv4abg().f[9]++;const car=(cov_2o3jjv4abg().s[51]++,mocks.validCar);const carCategory=(cov_2o3jjv4abg().s[52]++,{...mocks.validCarCategory,price:37.6,carIds:[car.id]});const customer=(cov_2o3jjv4abg().s[53]++,Object.create(mocks.validCustomer));cov_2o3jjv4abg().s[54]++;customer.age=20;const numberOfDays=(cov_2o3jjv4abg().s[55]++,5);const dueDate=(cov_2o3jjv4abg().s[56]++,'8 de março de 2022');const now=(cov_2o3jjv4abg().s[57]++,new Date(2022,2,3));cov_2o3jjv4abg().s[58]++;sandbox.useFakeTimers(now.getTime());// age: 20, tax: 1.1, categoryPrice: 37.6
// 37.6 * 1.1 = 41.36 * 5 days = 206.8
cov_2o3jjv4abg().s[59]++;sandbox.stub(carService.carRepository,carService.carRepository.find.name).resolves(car);const expectedAmount=(cov_2o3jjv4abg().s[60]++,carService.currencyFormat.format(206.8));const result=(cov_2o3jjv4abg().s[61]++,await carService.rent(customer,carCategory,numberOfDays));const expected=(cov_2o3jjv4abg().s[62]++,new Transaction({customer,car,amount:expectedAmount,dueDate}));cov_2o3jjv4abg().s[63]++;expect(result).to.be.deep.equal(expected);});});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhclNlcnZpY2UudGVzdC5qcyJdLCJuYW1lcyI6WyJkZXNjcmliZSIsIml0IiwiYmVmb3JlIiwiYmVmb3JlRWFjaCIsImFmdGVyRWFjaCIsInJlcXVpcmUiLCJleHBlY3QiLCJzaW5vbiIsImpvaW4iLCJDYXJTZXJ2aWNlIiwiVHJhbnNhY3Rpb24iLCJjYXJzRGF0YWJhc2UiLCJfX2Rpcm5hbWUiLCJtb2NrcyIsInZhbGlkQ2FyQ2F0ZWdvcnkiLCJ2YWxpZENhciIsInZhbGlkQ3VzdG9tZXIiLCJjYXJTZXJ2aWNlIiwiY2FycyIsInNhbmRib3giLCJjcmVhdGVTYW5kYm94IiwicmVzdG9yZSIsImRhdGEiLCJyZXN1bHQiLCJnZXRSYW5kb21Qb3NpdGlvbkZyb21BcnJheSIsInRvIiwiYmUiLCJsdGUiLCJsZW5ndGgiLCJhbmQiLCJndGUiLCJjYXJDYXRlZ29yeSIsImNhcklkSW5kZXgiLCJzdHViIiwibmFtZSIsInJldHVybnMiLCJjaG9vc2VSYW5kb21DYXIiLCJleHBlY3RlZCIsImNhcklkcyIsImNhbGxlZE9uY2UiLCJvayIsImVxdWFsIiwiY2FyIiwiT2JqZWN0IiwiY3JlYXRlIiwiaWQiLCJjYXJSZXBvc2l0b3J5IiwiZmluZCIsInJlc29sdmVzIiwic3B5IiwiZ2V0QXZhaWxhYmxlQ2FyIiwiY2FsbGVkV2l0aEV4YWN0bHkiLCJkZWVwIiwiY3VzdG9tZXIiLCJhZ2UiLCJwcmljZSIsIm51bWJlck9mRGF5cyIsImdldCIsImZyb20iLCJ0aGVuIiwiY3VycmVuY3lGb3JtYXQiLCJmb3JtYXQiLCJjYWxjdWxhdGVGaW5hbFByaWNlIiwiZHVlRGF0ZSIsIm5vdyIsIkRhdGUiLCJ1c2VGYWtlVGltZXJzIiwiZ2V0VGltZSIsImV4cGVjdGVkQW1vdW50IiwicmVudCIsImFtb3VudCJdLCJtYXBwaW5ncyI6ImtsTUFlWTsyRkFmWixLQUFNLENBQUVBLFFBQUYsQ0FBWUMsRUFBWixDQUFnQkMsTUFBaEIsQ0FBd0JDLFVBQXhCLENBQW9DQyxTQUFwQywyQkFB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QSxRQUFRLDJCQUFHLEdBQUkzQixDQUFBQSxXQUFKLENBQWdCLENBQy9CMkMsUUFEK0IsQ0FFL0JYLEdBRitCLENBRy9CNEIsTUFBTSxDQUFFRixjQUh1QixDQUkvQkwsT0FKK0IsQ0FBaEIsQ0FBSCxDQUFkLENBMUIyRix5QkFpQzNGekQsTUFBTSxDQUFDaUIsTUFBRCxDQUFOLENBQWVFLEVBQWYsQ0FBa0JDLEVBQWxCLENBQXFCMEIsSUFBckIsQ0FBMEJYLEtBQTFCLENBQWdDSixRQUFoQyxFQUNELENBbENDLENBQUYsQ0FtQ0QsQ0FySE8sQ0FBUiIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgZGVzY3JpYmUsIGl0LCBiZWZvcmUsIGJlZm9yZUVhY2gsIGFmdGVyRWFjaCB9ID0gcmVxdWlyZSgnbW9jaGEnKVxuY29uc3QgeyBleHBlY3QgfSA9IHJlcXVpcmUoJ2NoYWknKVxuY29uc3Qgc2lub24gPSByZXF1aXJlKCdzaW5vbicpXG5cbmNvbnN0IHsgam9pbiB9ID0gcmVxdWlyZSgncGF0aCcpXG5jb25zdCBDYXJTZXJ2aWNlID0gcmVxdWlyZSgnLi4vLi4vc3JjL3NlcnZpY2UvY2FyU2VydmljZScpXG5jb25zdCBUcmFuc2FjdGlvbiA9IHJlcXVpcmUoJy4vLi4vLi4vc3JjL2VudGl0aWVzL3RyYW5zYWN0aW9uJylcblxuY29uc3QgY2Fyc0RhdGFiYXNlID0gam9pbihfX2Rpcm5hbWUsICcuLy4uLy4uL2RhdGFiYXNlJywgJ2NhcnMuanNvbicpXG5cbmNvbnN0IG1vY2tzID0ge1xuICB2YWxpZENhckNhdGVnb3J5OiByZXF1aXJlKCcuLy4uL21vY2tzL3ZhbGlkLWNhckNhdGVnb3J5Lmpzb24nKSxcbiAgdmFsaWRDYXI6IHJlcXVpcmUoJy4vLi4vbW9ja3MvdmFsaWQtY2FyLmpzb24nKSxcbiAgdmFsaWRDdXN0b21lcjogcmVxdWlyZSgnLi8uLi9tb2Nrcy92YWxpZC1jdXN0b21lci5qc29uJyksXG59XG5cbmRlc2NyaWJlKCdDYXJTZXJ2aWNlIFRlc3RzIFN1aXRlJywgKCkgPT4ge1xuICBsZXQgY2FyU2VydmljZSA9IHt9XG5cbiAgYmVmb3JlKCgpID0+IHtcbiAgICBjYXJTZXJ2aWNlID0gbmV3IENhclNlcnZpY2Uoe1xuICAgICAgY2FyczogY2Fyc0RhdGFiYXNlLFxuICAgIH0pXG4gIH0pXG5cbiAgYmVmb3JlRWFjaCgoKSA9PiB7XG4gICAgc2FuZGJveCA9IHNpbm9uLmNyZWF0ZVNhbmRib3goKVxuICB9KVxuXG4gIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgc2FuZGJveC5yZXN0b3JlKClcbiAgfSlcblxuICBpdCgnc2hvdWxkIHJldHJpZXZlIGEgcmFuZG9tIHBvc2l0aW9uIGZyb20gdGhlIGFycmF5JywgKCkgPT4ge1xuICAgIGNvbnN0IGRhdGEgPSBbMCwgMSwgMiwgMywgNF1cbiAgICBjb25zdCByZXN1bHQgPSBjYXJTZXJ2aWNlLmdldFJhbmRvbVBvc2l0aW9uRnJvbUFycmF5KGRhdGEpXG4gICAgZXhwZWN0KHJlc3VsdCkudG8uYmUubHRlKGRhdGEubGVuZ3RoKS5hbmQuYmUuZ3RlKDApXG4gIH0pXG5cbiAgaXQoJ3Nob3VsZCBjaG9vc2UgdGhlIGZpcnN0IGlkIGZyb20gY2FySWRzIGluIGNhckNhdGVnb3J5JywgKCkgPT4ge1xuICAgIGNvbnN0IGNhckNhdGVnb3J5ID0gbW9ja3MudmFsaWRDYXJDYXRlZ29yeVxuICAgIGNhcklkSW5kZXggPSAwXG5cbiAgICBzYW5kYm94XG4gICAgICAuc3R1YihjYXJTZXJ2aWNlLCBjYXJTZXJ2aWNlLmdldFJhbmRvbVBvc2l0aW9uRnJvbUFycmF5Lm5hbWUpXG4gICAgICAucmV0dXJucyhjYXJJZEluZGV4KVxuXG4gICAgY29uc3QgcmVzdWx0ID0gY2FyU2VydmljZS5jaG9vc2VSYW5kb21DYXIoY2FyQ2F0ZWdvcnkpXG4gICAgY29uc3QgZXhwZWN0ZWQgPSBjYXJDYXRlZ29yeS5jYXJJZHNbY2FySWRJbmRleF1cbiAgICBleHBlY3QoY2FyU2VydmljZS5nZXRSYW5kb21Qb3NpdGlvbkZyb21BcnJheS5jYWxsZWRPbmNlKS50by5iZS5va1xuICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLmVxdWFsKGV4cGVjdGVkKVxuICB9KVxuXG4gIGl0KCdnaXZlbiBhIGNhckNhdGVnb3J5IGl0IHNob3VsZCByZXR1cm4gYW4gYXZhaWxhYmxlIGNhcicsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBjYXIgPSBtb2Nrcy52YWxpZENhclxuICAgIGNvbnN0IGNhckNhdGVnb3J5ID0gT2JqZWN0LmNyZWF0ZShtb2Nrcy52YWxpZENhckNhdGVnb3J5KVxuICAgIGNhckNhdGVnb3J5LmNhcklkcyA9IFtjYXIuaWRdXG5cbiAgICBzYW5kYm94XG4gICAgICAuc3R1YihjYXJTZXJ2aWNlLmNhclJlcG9zaXRvcnksIGNhclNlcnZpY2UuY2FyUmVwb3NpdG9yeS5maW5kLm5hbWUpXG4gICAgICAucmVzb2x2ZXMoY2FyKVxuXG4gICAgc2FuZGJveC5zcHkoY2FyU2VydmljZSwgY2FyU2VydmljZS5jaG9vc2VSYW5kb21DYXIubmFtZSlcblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhclNlcnZpY2UuZ2V0QXZhaWxhYmxlQ2FyKGNhckNhdGVnb3J5KVxuICAgIGNvbnN0IGV4cGVjdGVkID0gY2FyXG4gICAgZXhwZWN0KGNhclNlcnZpY2UuY2hvb3NlUmFuZG9tQ2FyLmNhbGxlZE9uY2UpLnRvLmJlLm9rXG4gICAgZXhwZWN0KGNhclNlcnZpY2UuY2FyUmVwb3NpdG9yeS5maW5kLmNhbGxlZFdpdGhFeGFjdGx5KGNhci5pZCkpLnRvLmJlLm9rXG4gICAgZXhwZWN0KHJlc3VsdCkudG8uYmUuZGVlcC5lcXVhbChleHBlY3RlZClcbiAgfSlcblxuICBpdCgnZ2l2ZW4gYSBjYXJDYXRlZ29yeSwgY3VzdG9tZXIgYW5kIG51bWJlck9mRGF5cyBpdCBzaG91bGQgY2FsY3VsYXRlIHRoZSBmaW5hbCBhbW91bnQgaW4gcmVhbCcsIGFzeW5jICgpID0+IHtcbiAgICBjb25zdCBjdXN0b21lciA9IE9iamVjdC5jcmVhdGUobW9ja3MudmFsaWRDdXN0b21lcilcbiAgICBjdXN0b21lci5hZ2UgPSA1MFxuXG4gICAgY29uc3QgY2FyQ2F0ZWdvcnkgPSBPYmplY3QuY3JlYXRlKG1vY2tzLnZhbGlkQ2FyQ2F0ZWdvcnkpXG4gICAgY2FyQ2F0ZWdvcnkucHJpY2UgPSAzNy42XG5cbiAgICBjb25zdCBudW1iZXJPZkRheXMgPSA1XG5cbiAgICAvLyBhZ2U6IDUwIC0gdGF4OiAxLjMgLSBjYXRlZ29yeVByaWNlOiAzNy42XG4gICAgLy8gMzcuNiAqIDEuMyA9IDQ4Ljg4ICogNSBkYXlzID0gMjQ0LjQwXG5cbiAgICAvLyBkbyBub3QgZGVwZW5kIG9uIGV4dGVybmFsIGRhdGFcbiAgICBzYW5kYm94XG4gICAgICAuc3R1YihjYXJTZXJ2aWNlLCAndGF4ZXNCYXNlZE9uQWdlJylcbiAgICAgIC5nZXQoKCkgPT4gW3sgZnJvbTogNDAsIHRvOiA1MCwgdGhlbjogMS4zIH1dKVxuXG4gICAgY29uc3QgZXhwZWN0ZWQgPSBjYXJTZXJ2aWNlLmN1cnJlbmN5Rm9ybWF0LmZvcm1hdCgyNDQuNClcbiAgICBjb25zdCByZXN1bHQgPSBjYXJTZXJ2aWNlLmNhbGN1bGF0ZUZpbmFsUHJpY2UoXG4gICAgICBjdXN0b21lcixcbiAgICAgIGNhckNhdGVnb3J5LFxuICAgICAgbnVtYmVyT2ZEYXlzXG4gICAgKVxuXG4gICAgZXhwZWN0KHJlc3VsdCkudG8uYmUuZGVlcC5lcXVhbChleHBlY3RlZClcbiAgfSlcblxuICBpdCgnZ2l2ZW4gYSBjdXN0b21lciBhbmQgYSBjYXIgY2F0ZWdvcnkgaXQgc2hvdWxkIHJldHVybiBhIHRyYW5zYWN0aW9uIHJlY2VpcHQnLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgY2FyID0gbW9ja3MudmFsaWRDYXJcbiAgICBjb25zdCBjYXJDYXRlZ29yeSA9IHtcbiAgICAgIC4uLm1vY2tzLnZhbGlkQ2FyQ2F0ZWdvcnksXG4gICAgICBwcmljZTogMzcuNixcbiAgICAgIGNhcklkczogW2Nhci5pZF0sXG4gICAgfVxuXG4gICAgY29uc3QgY3VzdG9tZXIgPSBPYmplY3QuY3JlYXRlKG1vY2tzLnZhbGlkQ3VzdG9tZXIpXG4gICAgY3VzdG9tZXIuYWdlID0gMjBcblxuICAgIGNvbnN0IG51bWJlck9mRGF5cyA9IDVcbiAgICBjb25zdCBkdWVEYXRlID0gJzggZGUgbWFyw6dvIGRlIDIwMjInXG5cbiAgICBjb25zdCBub3cgPSBuZXcgRGF0ZSgyMDIyLCAyLCAzKVxuICAgIHNhbmRib3gudXNlRmFrZVRpbWVycyhub3cuZ2V0VGltZSgpKVxuICAgIC8vIGFnZTogMjAsIHRheDogMS4xLCBjYXRlZ29yeVByaWNlOiAzNy42XG4gICAgLy8gMzcuNiAqIDEuMSA9IDQxLjM2ICogNSBkYXlzID0gMjA2LjhcblxuICAgIHNhbmRib3hcbiAgICAgIC5zdHViKGNhclNlcnZpY2UuY2FyUmVwb3NpdG9yeSwgY2FyU2VydmljZS5jYXJSZXBvc2l0b3J5LmZpbmQubmFtZSlcbiAgICAgIC5yZXNvbHZlcyhjYXIpXG5cbiAgICBjb25zdCBleHBlY3RlZEFtb3VudCA9IGNhclNlcnZpY2UuY3VycmVuY3lGb3JtYXQuZm9ybWF0KDIwNi44KVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGNhclNlcnZpY2UucmVudChjdXN0b21lciwgY2FyQ2F0ZWdvcnksIG51bWJlck9mRGF5cylcblxuICAgIGNvbnN0IGV4cGVjdGVkID0gbmV3IFRyYW5zYWN0aW9uKHtcbiAgICAgIGN1c3RvbWVyLFxuICAgICAgY2FyLFxuICAgICAgYW1vdW50OiBleHBlY3RlZEFtb3VudCxcbiAgICAgIGR1ZURhdGUsXG4gICAgfSlcblxuICAgIGV4cGVjdChyZXN1bHQpLnRvLmJlLmRlZXAuZXF1YWwoZXhwZWN0ZWQpXG4gIH0pXG59KVxuIl19